after update windows 10, windows overwrite grub, it can't boot up
press ESC when press power button, then get boot choice, choose linux,
then you can get into grub2, `configfile (hd1,gpt7)/boot/grub/grub.cfg`
so you can get into archlinux, then
`grub-install --target x86_64-efi --efi-directory /efi/`
now you can choose boot windows or archlinux up
--------------------------------------------------
woeusb 和 winusb两款工具可在linux上使用windows的iso制作windows的启动盘
-----------------------------
old version of grub bug , wipe out /boot/esp and cann't install efi
said` cant open /boot/esp/EFI/"arch/bootx86.efi'
upgrade grub, and try it again,
but where's bootmgfw.efi for win10?
you can cop it from C:\Windows\Boot\EFI  to /boot/esp/EFI/Microsoft/Boot/
--------------------------------------
0. 先在主板设置里关掉secure boot和fast boot
1. 在主板设置里是可以选择启动先后顺序来启动不同系统，比如Win10 Archlinux，重启默认启动Win10
2. 如果把grub2设为了第一启动顺序，可以在grub2里启动Win10 Archlinux

假设/dev/sda1是ESP也就是EFI分区, 挂载在哪里不重要，关键是要写入这个分区，挂载在
/boot/efi或/mnt也可以，主要是写入这个分区,grub里调用使用的是(hd0,gpt1)而不是分区
mount /dev/sda1 /boot/esp  一定要指定设备，否则不知道装到哪去 no 还是自动把/dev/sda给突突了，但是>可以从bios指定grubx64.efi启动
grub-install --efi-directory /boot/esp  --boot-directory /boot  --target x86_64-efi /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg
vim /boot/grub/grub.cfg
menuentry "Microsoft Windows 10" {
        insmod part_gpt
        insmod fat
        insmod search_fs_uuid
        insmod chain
        search --fs-uuid --set=root $hints_string $fs_uuid
        chainloader (hd0,gpt1)/EFI/Microsoft/Boot/bootmgfw.efi
    }
$hints_string的值是命令# grub-probe --target=hints_string /boot/efi/EFI/Microsoft/Boot/bootmgfw.efi的输出.
$fs_uuid的值是命令# grub-probe --target=fs_uuid /boot/efi/EFI/Microsoft/Boot/bootmgfw.efi的输出.
reference: https://blog.icehoney.me/posts/2015-10-28-UEFI-dual-boot-Archlinux

安装intel-ucode之后重新生成grub.cfg,如果是amd就装linux-firmware
 grub-mkconfig -o /boot/grub/grub.cfg
上面这个win10启动可以写入/etc/grub.d/40_custom然后grub-mkconfig -o /boot/grub/grub.cfg生成进入
https://wiki.archlinux.org/index.php/Microcode
------------------------------------------------------------------------------------

制作一个可以在主板设置里boot from file的efi文件, 比如u盘fat32系统，挂载/mnt
grub-install --efi-directory /mnt/ --boot-directory /mnt --removable --target x86_64-efi
生成/mnt/EFI/BOOT/BOOTx64.EFI 可以直接从这个文件启动就能进入grub
也可以开机esc选择u盘uefi启动，会自动进入grub
insmod part_gpt
insmod ext2
linux (hd1,9)/ 按tab自动补全显示目录来找/boot/确定/的名字，因为装完arch和win10之后，又装了win7,所以sda6发生改变成了sda9
然后直接 configfile (hd1,9)/boot/grub/grub.cfg启动
或者再制作一个grub.cfg里面insmod part_gpt  insmod efi_gop efi_uga之类的就可以了

启动进入系统之后，修改/boot/grub/grub.cfg "set root=/dev/sda9" 
再运行次 grub-install --efi-directory /boot/esp  --boot-directory /boot  --target x86_64-efi
重启进入grub选win10那个选项会自动弹出选择win7还是win10

(hd1,gpt1)是EFI分区，windows和Linux的启动文件都在这里  (hd1,1)/EFI/arch/grubx64.efi
(hd1,1)/EFI/Microsoft/Boot/bootmgfw.efi

或者直接用 root=UUID=xxx取代 root=/dev/sda9 所有内核参数设置都应该写入/etc/default/grub然后grub-mkconfig -o /boot/grub/grub.cfg生成新的grub.cfg
直接在/boot/grub/grub.cfg改，更新内核后会恢复原装，所以在/etc/default/grub里改，然后grub-mkconfig -o /boot/grub/grub.cfg
lsblk -f可以显示各个分区的UUID
或者sudo blkid显示，blkid需要root权限

